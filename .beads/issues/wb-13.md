---
id: wb-13
title: "GET /api/boards/{id} returnerer 404 for eksisterende boards"
type: bug
status: open
priority: 1
created: 2026-02-11
---

# GET /api/boards/{id} returnerer 404 for eksisterende boards

Individuelle boards kan ikke hentes via API'et, selvom de eksisterer i board-listen.

## Reproducer

1. Opret en bruger og log ind
2. Opret et board (POST /api/boards returnerer 201)
3. Gå ind på boardet (board.html?id={uuid})

## Forventet

GET /api/boards/{id} returnerer board-data (HTTP 200).

## Faktisk

GET /api/boards/{id} returnerer 404 Not Found, selvom boardet vises korrekt i GET /api/boards listen.

## Mulig årsag

Routing-issue i reverse proxy - path med UUID-parameter bliver muligvis ikke forwarded korrekt til backend. Alternativt fejler databaseopslaget for det specifikke board.

## Netværkslog

```
[POST] https://whiteboard.udstillerguide.dk/api/boards => [201]
[GET]  https://whiteboard.udstillerguide.dk/api/boards => [200]  (listen virker)
[GET]  https://whiteboard.udstillerguide.dk/api/boards/{id} => [404]  (enkelt board fejler)
```

## Investigation (2026-02-11)

**Diagnosis: Reverse proxy issue - NOT a code bug**

### Backend code verified correct

- Route defined at `main.rs:80`: `.route("/api/boards/{id}", get(api::boards::get_board))`
- Handler at `api/boards.rs:130`: checks auth, then `user_has_access`, then `get_board`
- `user_has_access` at `db/boards.rs:162`: correctly checks owner first, then collaborator role
- `get_board` at `db/boards.rs:66`: straightforward `SELECT * FROM boards WHERE id = $1`
- If user has no access → handler returns 403 (not 404)
- If board doesn't exist → handler returns 404
- The fact that the user gets 404 (not 403) means the request never reaches the Axum handler

### Root cause

The network logs prove the issue: `/api/boards` (exact path) works for both GET and POST, but `/api/boards/{uuid}` (sub-path) returns 404. This is a classic reverse proxy path-matching issue.

The proxy is configured to match `/api/boards` as an exact path or with a rule that doesn't include sub-paths. Requests to `/api/boards/{uuid}` fall through to the proxy's default handler (likely a file server) which returns 404.

### Evidence

If this were a backend bug, the response would be:
- 403 (Forbidden) if `user_has_access` denied access
- 401 (Unauthorized) if the auth middleware rejected the token
- 500 if the database query failed

The 404 response means the request is not reaching the Axum backend at all.

### Secondary code quality note

In the handler, the error handling for `user_has_access` uses a catch-all `_` pattern:
```rust
match db::boards::user_has_access(...).await {
    Ok(Some(_)) => {}
    _ => { return FORBIDDEN }
}
```
This swallows `Err(e)` (database errors) as 403 instead of 500. Not related to this bug, but worth fixing for better error reporting.

### Fix required

The reverse proxy must forward all `/api/*` sub-paths to the backend. See wb-14 for the complete recommended proxy configuration.
